---
interface Props {
  id: string;
}
const { id } = Astro.props;
---

<span class="sidenote" data-sidenote-id={id}>
  <label class="sidenote-toggle" for={`sn-${id}`}>
    <sup class="sidenote-number"></sup>
  </label>
  <input type="checkbox" id={`sn-${id}`} class="sidenote-checkbox" />
  <span class="sidenote-content" data-sidenote-content>
    <span class="sidenote-content__number"></span>
    <slot />
  </span>
</span>

<style>
  .sidenote {
    counter-increment: sidenote-counter;
    display: inline;
    position: relative;
  }

  .sidenote-checkbox {
    display: none;
  }

  /* Superscript number marker - always visible */
  .sidenote-number::after {
    content: counter(sidenote-counter);
    font-size: 0.75em;
    font-weight: 600;
    color: var(--color-accent);
    vertical-align: super;
  }

  .sidenote-toggle {
    cursor: default;
  }

  /* DESKTOP: Hide inline content (shown in gutter via JS) */
  @media (min-width: 768px) {
    .sidenote-content {
      display: none !important;
    }
  }

  /* MOBILE: Toggleable inline block */
  @media (max-width: 767px) {
    .sidenote-toggle {
      cursor: pointer;
    }

    .sidenote-content {
      display: none;
      font-size: var(--text-sm);
      color: var(--color-text-secondary);
      background: var(--color-callout-bg);
      border: var(--border);
      border-radius: var(--radius-sm);
      padding: var(--space-4) var(--space-5);
      margin: var(--space-4) 0;
    }

    .sidenote-content__number::before {
      content: counter(sidenote-counter) ". ";
      font-weight: 600;
      color: var(--color-accent);
    }

    .sidenote-checkbox:checked ~ .sidenote-content {
      display: block;
      clear: both;
    }
  }
</style>
