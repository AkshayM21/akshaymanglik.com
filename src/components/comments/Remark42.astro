---
interface Props {
  url?: string;
  pageId?: string;
}

const { url = Astro.url.href, pageId = Astro.url.pathname } = Astro.props;

// Configure these values for your Remark42 instance
const REMARK42_HOST = import.meta.env.PUBLIC_REMARK42_HOST || 'https://comments.akshaymanglik.com';
const REMARK42_SITE_ID = import.meta.env.PUBLIC_REMARK42_SITE_ID || 'dereferenced';
---

<section class="comments" id="comments">
  <h2 class="comments__title">Comments</h2>
  <div id="remark42"></div>
</section>

<script define:vars={{ REMARK42_HOST, REMARK42_SITE_ID, url, pageId }}>
  // Remark42 configuration
  window.remark_config = {
    host: REMARK42_HOST,
    site_id: REMARK42_SITE_ID,
    url: url,
    page_title: document.title,
    theme: 'light',
    locale: 'en',
    show_email_subscription: false,
    simple_view: false,
    no_footer: false,
  };

  // Load Remark42 embed script
  // Note: Custom styling is applied via CSS mounted in the Remark42 server
  // See /public/remark42-custom.css for the custom styles
  (function() {
    const d = document;
    const s = d.createElement('script');
    s.src = `${REMARK42_HOST}/web/embed.js`;
    s.defer = true;
    s.async = true;
    d.head.appendChild(s);
  })();
</script>

<style>
  .comments {
    margin-top: var(--space-12);
    padding-top: var(--space-8);
    border-top: 1px dashed var(--color-divider);
  }

  .comments__title {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    font-weight: 600;
    color: var(--color-text-primary);
    margin-bottom: var(--space-6);
  }

  #remark42 {
    min-height: 200px;
  }
</style>
